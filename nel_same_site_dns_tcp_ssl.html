<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <script defer src='https://portalstage.catchpoint.com/jp/94643/latest/InitialLoadScript.js'></script>
  <title>NEL Origin-Scoped: DNS, TCP, and SSL Error Triggers</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font-family: system-ui, Arial, sans-serif; margin: 2rem; }
    h1 { margin-bottom: 0.5rem; }
    .desc { color: #555; margin-bottom: 1.25rem; }
    .row { display: flex; flex-wrap: wrap; gap: 1rem; margin-bottom: 1.5rem; }
    button { padding: 0.7rem 1rem; font-size: 0.95rem; cursor: pointer; }
    #log { white-space: pre-wrap; background: #f6f7f9; border: 1px solid #ddd; padding: 1rem; min-height: 6rem; }
    .small { font-size: 0.85rem; color: #666; }
    code { background: #f1f3f5; padding: 0 0.25rem; }
  </style>
</head>
<body>
  <h1>Network Error Triggers (Same-Site)</h1>
  <p class="desc">These buttons trigger errors from the same-site subdomains of <code>exquisite-gingersnap-99c11c.netlify.app</code> so <strong>Network Error Logging (NEL)</strong> will capture them under a policy with <code>include_subdomains:true</code>.</p>

  <div class="row">
    <button id="btn-dns">DNS Failure (NXDOMAIN)</button>
    <button id="btn-connect">TCP Connect Failure</button>
    <button id="btn-ssl">SSL/TLS Handshake Failure</button>
  </div>

  <div id="log" aria-live="polite"></div>
  <p class="small">Open DevTools â†’ Network to see the failing fetches. NEL reports are sent via <code>Report-To</code> to your collector.</p>

  <script>
    // Fixed to your Netlify site and its subdomains
    const DNS_FAIL_URL     = 'https://nohost.exquisite-gingersnap-99c11c.netlify.app/missing.jpg';
    const CONNECT_FAIL_URL = 'https://dead-end.exquisite-gingersnap-99c11c.netlify.app/test.txt';
    const SSL_FAIL_URL     = 'https://expired.exquisite-gingersnap-99c11c.netlify.app/';

    const log = (msg) => {
      const el = document.getElementById('log');
      const time = new Date().toLocaleTimeString();
      el.innerHTML = `${el.innerHTML}\n[${time}] ${msg}`;
    };

    async function tryFetch(url, label) {
      log(`${label}: fetching ${url}`);
      try {
        const res = await fetch(url, { mode: 'no-cors', cache: 'no-store' });
        log(`${label}: fetch attempted (NEL should capture any network failure).`);
      } catch (e) {
        log(`${label}: fetch threw (${e && e.message ? e.message : e}).`);
      }
    }

    document.getElementById('btn-dns').addEventListener('click', () =>
      tryFetch(DNS_FAIL_URL, 'DNS Failure (NXDOMAIN)')
    );

    document.getElementById('btn-connect').addEventListener('click', () =>
      tryFetch(CONNECT_FAIL_URL, 'TCP Connect Failure')
    );

    document.getElementById('btn-ssl').addEventListener('click', () =>
      tryFetch(SSL_FAIL_URL, 'SSL/TLS Handshake Failure')
    );

    log('Ensure the main page response has "Report-To" and "NEL" headers with include_subdomains:true.');
  </script>
</body>
</html>